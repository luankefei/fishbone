"use strict";!function(n,t){function e(n){return e.fn.init(n)}function o(n,t){var e,o=[].slice.call(arguments),r=1,i="boolean"==typeof o[o.length-1]?o.pop():!0;for(1===o.length&&(n=this.window?{}:this,r=0);t=o[r++];)for(e in t)!Object.prototype.hasOwnProperty.call(t,e)||!i&&e in n||(n[e]=t[e]);return n}var r=t.dispatchEvent,i=(t.documentElement,t.head||t.getElementsByTagName("head"),1);e.fn=e.prototype,o(e.fn,{mix:o,nodes:[],fishbone:i,constructor:e,length:0,init:function(n){if(n.nodeName)this.nodes=n,this.selector=null;else{this.selector=n;var o=n.split(" ");1===o.length&&"#"===o[0].charAt(0)?this.nodes=t.querySelector(o[0]):(this.nodes=t.querySelectorAll(n),this.nodes=Array.prototype.slice.call(this.nodes))}var r=Object.create(e.fn);return r.nodes=this.nodes,r.selector=this.selector,r}}),String.prototype.byteLen=function(n,t){t=t?t:2;var e=new Array(t+1).join("-");return n.replace(/[^\x00-\xff]/g,e).length},Array.prototype.random=function(n){return n[Math.floor(Math.random()*n.length)]},Array.prototype.flatten=function(n){var t=[];n.forEach(function(n){return Array.isArray[n]?t=t.concat(Array.prototype.flatten(n)):t.push(n),t})},Array.prototype.min=function(n){return Math.min.apply(0,n)},Array.prototype.max=function(n){return Math.max.apply(0,n)},Array.prototype.unique=function(){this.sort();for(var n=["1"],t=1;t<this.length;t++)this[t]!==n[n.length-1]&&n.push(this[t]);return n.shift(),n},Array.prototype.union=function(n,t){return n.concat(t).unique()},Array.prototype.first=function(){return this[0]},Array.prototype.last=function(){return this[this.length-1]};var a={},s={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0};a.get=function(n,t){var e=s;e.url=n,a.ajax(e,t)},a.ajax=function(n,t,e){var o=n.url,r=n.type?n.type.toUpperCase():s.type,i=n.data||null,a=new XMLHttpRequest;if(a.open(r,o),"undefined"!=typeof e)for(var c in e)a["on"+c]=e[c];a.onreadystatechange=function(){if(200===a.status&&4===a.readyState){var n=a.responseText;t&&t(n)}},a.setRequestHeader("Content-type",s.contentType),a.send(i)},a.jsonp=function(n,t,e,o){var r=document.createElement("script"),i=document.querySelector("body");r.src=n+"?type=jsonp&callbackName="+e,r.id="jsonp",r.onload=o,window[e]=t.funcName,i.appendChild(r)},a.comet=function(){},a.socket=function(){};var c={};c.append=function(n){return 1===this.nodes.length?this.nodes.appendChild(n):this.nodes.forEach(function(t){var e=n.cloneNode(!0);t.appendChild(e)}),this},c.prepend=function(n){return this.nodes.nodeName?this.nodes.insertBefore(n,this.nodes.childNodes[0]):this.nodes.forEach(function(t){var e=n.cloneNode(!0);t.insertBefore(e,t.childNodes[0])}),this},c.clone=function(n){if(this.nodes.nodeName)return this.nodes.cloneNode(n);var t=[];return this.nodes.forEach(function(e){t.push(e.cloneNode(n))}),t},c.html=function(n){var t=this.nodes;return void 0!==n?(t.nodeName?t.innerHTML=n:t.forEach(function(t,e,o){t.innerHTML=n}),this):t.nodeName?t.innerHTML:""},c.remove=function(){var n=this.nodes;if(n instanceof Array)for(var t=0,e=n.length;e>t;t++){var o=n[t];o.parentNode.removeChild(o)}else n.parentNode.removeChild(n);return null},c.empty=function(){},c.after=function(){},c.before=function(){},c.css=function(){},c.width=function(){},c.attr=function(n,t){},c.eq=function(n){var t=null;try{t=this.nodes[n],t=e.fn.init(t)}catch(o){console.error("$.fn.eq只能用于复数节点集合")}return t},c.first=function(){return c.eq.call(this,0)},c.last=function(){return c.eq.call(this,this.nodes.length-1)};var u={};u.provider=function(n){var t=this,e={},o=function(){var n=window.location.hash,t=window.history;n=n.replace("#!",""),t.replaceState(null,null,n)};return this.when=function(n,o){return e[n]=o,t},this.otherwise=function(n){e.otherwise=n,u.routes=e,window.addEventListener("hashchange",o)},this};var l={};l.addEvent=function(n,t,e){n.addEventListener?n.addEventListener(t,e,!1):n.attachEvent("on"+t,function(t){return e.call(n,t)})},l.removeEvent=function(n,t,e){void 0===e&&(n["on"+t]=null),n.removeEventListener?n.removeEventListener(t,e,!1):n.detechEvent("on"+t,e)},l.live=function(n,t){var e=this.selector;document.addEventListener(n,function(n){for(var o=document.querySelectorAll(e),r=0;r<o.length;r++)if(o[r]===n.target)return t.call(n.target,n)})},l.on=function(n,t){var e=this.nodes;e.nodeName?l.addEvent(e,n,t):e.forEach(function(e,o,r){l.addEvent(e,n,t)})},l.ready=function(n){var e=r?"DOMContentLoaded":"readystatechange",o=null;this.nodes===document&&("readystatechange"===e?o=function(){"complete"===t.readyState&&Function.call(n)}:l.addEvent(this.nodes,e,o,!1))},l.unbind=function(){};var d={};d.Component=function(){return this.node=null,this.view=null,this.controller=null,this.model=null,this.init=function(n){return this.node=n,this.model.init.call(this,function(){}),this},this},d.component={},d.component.init=function(n,t){var e=new d.Component;return e=Object.defineProperties(e,{data:{enumerable:!0,configurable:!0,get:function(){return this.value},set:function(n){this.value=n,this.controller.refresh(this.node)}}}),t.call(this,e)},o(e,{mix:o,get:a.get,ajax:a.ajax,jsonp:a.jsonp,route:u,on:l.on,live:l.live,module:d.init,component:d.component.init}),o(e.fn,c),o(e.fn,{on:l.on,live:l.live,ready:l.ready}),n.$=n.Fishbone=e}(window,window.document);