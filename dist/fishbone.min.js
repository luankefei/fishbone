"use strict";!function(n,e){function t(n){return t.fn.init(n)}function o(n,e){var t,o=[].slice.call(arguments),r=1,i="boolean"==typeof o[o.length-1]?o.pop():!0;for(1===o.length&&(n=this.window?{}:this,r=0);e=o[r++];)for(t in e)!Object.prototype.hasOwnProperty.call(e,t)||!i&&t in n||(n[t]=e[t]);return n}var r=e.dispatchEvent,i=(e.documentElement,e.head||e.getElementsByTagName("head"),1);t.fn=t.prototype,o(t.fn,{mix:o,nodes:[],fishbone:i,constructor:t,length:0,init:function(n){if(n.nodeName)this.nodes=n,this.selector=null;else{this.selector=n;var o=n.split(" ");1===o.length&&"#"===o[0].charAt(0)?this.nodes=e.querySelector(o[0]):(this.nodes=e.querySelectorAll(n),this.nodes=Array.prototype.slice.call(this.nodes))}var r=Object.create(t.fn);return r.nodes=this.nodes,r.selector=this.selector,r}}),String.prototype.byteLen=function(n,e){e=e?e:2;var t=new Array(e+1).join("-");return n.replace(/[^\x00-\xff]/g,t).length},Array.prototype.random=function(n){return n[Math.floor(Math.random()*n.length)]},Array.prototype.flatten=function(n){var e=[];n.forEach(function(n){return Array.isArray[n]?e=e.concat(Array.prototype.flatten(n)):e.push(n),e})},Array.prototype.min=function(n){return Math.min.apply(0,n)},Array.prototype.max=function(n){return Math.max.apply(0,n)},Array.prototype.unique=function(){this.sort();for(var n=["1"],e=1;e<this.length;e++)this[e]!==n[n.length-1]&&n.push(this[e]);return n.shift(),n},Array.prototype.union=function(n,e){return n.concat(e).unique()},Array.prototype.first=function(){return this[0]},Array.prototype.last=function(){return this[this.length-1]};var a={},s={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0};a.get=function(n,e){var t=s;t.url=n,a.ajax(t,e)},a.ajax=function(n,e,t){var o=n.url,r=n.type?n.type.toUpperCase():s.type,i=n.data||null,a=new XMLHttpRequest;if(a.open(r,o),"undefined"!=typeof t)for(var c in t)a["on"+c]=t[c];a.onreadystatechange=function(){if(200===a.status&&4===a.readyState){var n=a.responseText;e&&e(n)}},a.setRequestHeader("Content-type",s.contentType),a.send(i)},a.jsonp=function(n,e,t,o){var r=document.createElement("script"),i=document.querySelector("body");r.src=n+"?type=jsonp&callbackName="+t,r.id="jsonp",r.onload=o,window[t]=e.funcName,i.appendChild(r)},a.comet=function(){},a.socket=function(){};var c={};c.append=function(n){return 1===this.nodes.length?this.nodes.appendChild(n):this.nodes.forEach(function(e){var t=n.cloneNode(!0);e.appendChild(t)}),this},c.prepend=function(n){return this.nodes.nodeName?this.nodes.insertBefore(n,this.nodes.childNodes[0]):this.nodes.forEach(function(e){var t=n.cloneNode(!0);e.insertBefore(t,e.childNodes[0])}),this},c.clone=function(n){if(this.nodes.nodeName)return this.nodes.cloneNode(n);var e=[];return this.nodes.forEach(function(t){e.push(t.cloneNode(n))}),e},c.html=function(n){var e=this.nodes;return void 0!==n?(e.nodeName?e.innerHTML=n:e.forEach(function(e,t,o){e.innerHTML=n}),this):e.nodeName?e.innerHTML:""},c.remove=function(){var n=this.nodes;if(n instanceof Array)for(var e=0,t=n.length;t>e;e++){var o=n[e];o.parentNode.removeChild(o)}else n.parentNode.removeChild(n);return null},c.empty=function(){},c.after=function(){},c.before=function(){},c.css=function(){},c.width=function(){},c.attr=function(n,e){},c.eq=function(n){var e=null;try{e=this.nodes[n],e=t.fn.init(e)}catch(o){console.error("$.fn.eq只能用于复数节点集合")}return e},c.first=function(){return c.eq.call(this,0)},c.last=function(){return c.eq.call(this,this.nodes.length-1)};var u={};u.provider=function(n){var e=this,t={},o=function(){var n=window.location.hash,e=window.history;n=n.replace("#!",""),e.replaceState(null,null,n)};return this.when=function(n,o){return t[n]=o,e},this.otherwise=function(n){t.otherwise=n,u.routes=t,window.addEventListener("hashchange",o)},this};var l={};l.addEvent=function(n,e,t){n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,function(e){return t.call(n,e)})},l.removeEvent=function(n,e,t){void 0===t&&(n["on"+e]=null),n.removeEventListener?n.removeEventListener(e,t,!1):n.detechEvent("on"+e,t)},l.live=function(n,e){var t=this.selector;document.addEventListener(n,function(n){for(var o=document.querySelectorAll(t),r=0;r<o.length;r++)if(o[r]===n.target)return e.call(n.target,n)})},l.on=function(n,e){var t=this.nodes;t.nodeName?l.addEvent(t,n,e):t.forEach(function(t,o,r){l.addEvent(t,n,e)})},l.ready=function(n){var t=r?"DOMContentLoaded":"readystatechange",o=null;this.nodes===document&&("readystatechange"===t?o=function(){"complete"===e.readyState&&Function.call(n)}:l.addEvent(this.nodes,t,o,!1))},l.unbind=function(){};var h={};h.Component=function(){return this.node=null,this.view=null,this.controller=null,this.model=null,this.init=function(n){return this.node=n,this.model.init.call(this,function(){}),this},this},h.component={},h.component.init=function(n,e){var t=new h.Component;return t=Object.defineProperties(t,{data:{enumerable:!0,configurable:!0,get:function(){return this.value},set:function(n){this.value=n,this.controller.refresh(this.node)}}}),e.call(this,t)};var d={};d.validateChange=function(n){return"+"===n[0]||"-"===n[0]},d.handleSeperator=function(n){var e=n.indexOf("-");return-1!==e&&(n=n.replace("-",""),n=n.substring(0,e)+n[e].toUpperCase()+n.substring(e+1)),n},d.calculateChange=function(n,e){var t=d.getCss.call(this,n);return t=Number.parseInt(t.substring(0,t.length-2)),e=Number.parseInt(e.substring(0,e.length-2)),e=t+e+"px"},d.setCss=function(n,e){var t=d.validateChange(e);if(t&&(e=d.calculateChange.apply(this,[n,e])),n=d.handleSeperator(n),void 0!==this.nodes.nodeName)this.nodes.style[n]=e;else for(var o=0,r=this.nodes.length;r>o;o++)this.nodes[o].style[n]=e;return this},d.getCss=function(e){var t=null,o=this.nodes;return o.nodeName||(o=this.nodes[0]),t=n.getComputedStyle(o,null).getPropertyValue(e)},d.init=function(n,e){var t=null;return t=void 0===e?d.getCss.call(this,n):d.setCss.call(this,n,e)},o(t,{mix:o,get:a.get,ajax:a.ajax,jsonp:a.jsonp,route:u,on:l.on,live:l.live,module:h.init,component:h.component.init}),o(t.fn,c),o(t.fn,{on:l.on,live:l.live,ready:l.ready,css:d.init}),n.$=n.Fishbone=t}(window,window.document);